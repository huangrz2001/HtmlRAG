
---

## ğŸ” RAG æ£€ç´¢æœåŠ¡æ¥å£æ–‡æ¡£

> ğŸŒ **Base URL**ï¼š`http://192.168.7.179:80`  
> ğŸŒ **RAG docs**ï¼š`http://localhost:80/rag/docs`  
> ğŸŒ **é—®ç­”å¯¹CURD docs**ï¼š`http://localhost:80/qa/docs`  
> ğŸŒ **æ–‡æ¡£CURDåŠqueryé‡å†™ docs**ï¼š`http://localhost:80/document/docs`
---

### ğŸ“¡ `/query` - æŸ¥è¯¢å‚è€ƒå†…å®¹

**å®Œæ•´è·¯å¾„**ï¼š`POST http://192.168.7.179:80/rag/query`

**æè¿°**ï¼šæ ¹æ®ç”¨æˆ·æå‡ºçš„é—®é¢˜ï¼Œåœ¨å·²å‘é‡åŒ–çš„æ–‡æ¡£åº“ä¸­æ£€ç´¢åŒ¹é…å†…å®¹

#### ğŸ“¤ è¯·æ±‚ä½“ï¼ˆQueryRequestï¼‰

```json
{
  "question": "å¦‚ä½•ä¼˜åŒ–å¹¿å‘ŠæŠ•æ”¾æ•ˆæœï¼Ÿ",
  "limit": 16
}
```
#### âœ… è¿”å›å€¼ï¼ˆæˆåŠŸï¼‰
```json
{
  "status": "success",
  "results": [
    {
      "text":"æ–¹å‘  é—®é¢˜ç‚¹  æ€ä¹ˆåšï¼Ÿ...",
      "page_url":"æ€»çŸ¥è¯†åº“_cleaned/å·¨é‡æœ¬åœ°æ¨å¸®åŠ©ä¸­å¿ƒ/åŠŸèƒ½ä»‹ç»/å·¨é‡æœ¬åœ°æ¨ç›´æ’­å…¨åŸŸæ¨å¹¿äº§å“æ‰‹å†Œ.html",
      "page_name":"å·¨é‡æœ¬åœ°æ¨ç›´æ’­å…¨åŸŸæ¨å¹¿äº§å“æ‰‹å†Œ",
      "chunk_idx":6,
      "title":"äº”ã€æ€ä¹ˆæŠ•æ”¾æ•ˆæœå¥½ï¼Ÿâ€‹ è¡¨æ ¼è¡Œ1-7",
      "summary":"è¿›è¡Œå…¨åŸŸæ¨å¹¿æ—¶ï¼Œ...",
      "time":"2025-04-23 17:58:33"
    }
  ],
  "reference_contents": [
    "[å†…å®¹1]:...",
    "[å†…å®¹1]:...",
    ...
  ],
  "processing_time": 1.4188416004180908
}
```
#### âŒ è¿”å›å€¼ï¼ˆå¤±è´¥ï¼‰

```json
{
  "status": "failed",
  "processing_time": 0.4188416004180908
}
```

---

## ğŸ’¬ é—®ç­”å¯¹CURD æœåŠ¡æ¥å£æ–‡æ¡£

> ğŸŒ **Base URL**ï¼š`http://192.168.7.179:80/qa`

---

### ğŸ“¥ `/insert` - æ’å…¥é—®ç­”å¯¹

**å®Œæ•´è·¯å¾„**ï¼š`POST http://192.168.7.179:80/qa/insert`

**æè¿°**ï¼šå°†é—®ç­”æ•°æ®æ’å…¥å‘é‡æ•°æ®åº“ï¼Œç”¨äºåç»­ç›´æ¥å¤ç”¨ã€‚

#### ğŸ“¤ è¯·æ±‚ä½“

```json
{
  "qa_index": 10086,
  "question": "å¦‚ä½•ä¼˜åŒ–å¹¿å‘ŠæŠ•æ”¾æ•ˆæœï¼Ÿ"
}
```
#### âœ… è¿”å›å€¼ï¼ˆæˆåŠŸï¼‰
```json
{
  "status": "inserted",
  "qa_index": 10086,
  "question": "å¦‚ä½•ä¼˜åŒ–å¹¿å‘ŠæŠ•æ”¾æ•ˆæœï¼Ÿ"
}
```
#### âŒ è¿”å›å€¼ï¼ˆå¤±è´¥ï¼‰

```json
{
  "status": "failed",
  "qa_index": 10086,
  "qa_index": "å¦‚ä½•ä¼˜åŒ–å¹¿å‘ŠæŠ•æ”¾æ•ˆæœï¼Ÿ"
}
```
---

### ğŸ” `/search` - æ£€ç´¢è¯­ä¹‰ç›¸ä¼¼é—®é¢˜

**å®Œæ•´è·¯å¾„**ï¼š`POST http://192.168.7.179:80/qa/search`

**æè¿°**ï¼šåœ¨å‘é‡æ•°æ®åº“ä¸­åŸºäºè¯­ä¹‰æŸ¥æ‰¾ä¸è¾“å…¥é—®é¢˜ç›¸ä¼¼çš„é—®å¥ã€‚

#### ğŸ“¤ è¯·æ±‚ä½“

```json
{
  "question": "å¦‚ä½•ä¼˜åŒ–å¹¿å‘ŠæŠ•æ”¾æ•ˆæœï¼Ÿ",
  "top_k": 5
}
```
#### âœ… è¿”å›å€¼ï¼ˆæˆåŠŸï¼‰
```json
{
  [
    {
      "qa_index": 10086,
      "question": "å¦‚ä½•ä¼˜åŒ–å¹¿å‘ŠæŠ•æ”¾æ•ˆæœï¼Ÿ",
      "distance": 0.987527362731,
    },

    {
      ...
    },
    ...
  ]
}
```
#### âŒ è¿”å›å€¼ï¼ˆå¤±è´¥ï¼‰

```json
{
  "status": "failed"
}
```
---

### ğŸ—‘ï¸ `/delete` - åˆ é™¤é—®ç­”å¯¹

**å®Œæ•´è·¯å¾„**ï¼š`POST http://192.168.7.179:80/qa/delete`

**æè¿°**ï¼šæ ¹æ®ç´¢å¼•å·ä»å‘é‡åº“ä¸­åˆ é™¤æŸæ¡é—®ç­”è®°å½•ã€‚

#### ğŸ“¤ è¯·æ±‚ä½“

```json
{
  "qa_index": 10086
}
```
#### âœ… è¿”å›å€¼ï¼ˆæˆåŠŸï¼‰
```json
{
  "status": "deleted",
  "qa_index": 10086,
  "delete_count": 1
}
```
#### âŒ è¿”å›å€¼ï¼ˆå¤±è´¥ï¼‰

```json
{
  "status": "failed",
  "qa_index": 10086,
  "error": "..."
}
```

---

## ğŸ“„ æ–‡æ¡£CURDåŠqueryé‡å†™ æœåŠ¡æ¥å£æ–‡æ¡£

> ğŸŒ **Base URL**ï¼š`http://192.168.7.179:80/document`

---

### ğŸ“¥ `/add` - æ–°å¢æ–‡æ¡£

**å®Œæ•´è·¯å¾„**ï¼š`POST http://192.168.7.179:80/document/add`

**æè¿°**ï¼šå‘æ–‡æ¡£åº“æ’å…¥ä¸€ä¸ª HTML é¡µé¢å†…å®¹ï¼Œæ–‡æ¡£å°†è¢«è§£æä¸ºç»“æ„åŒ–è¯­ä¹‰å—ï¼Œç”¨äºå‘é‡åŒ–æ£€ç´¢ã€‚

#### ğŸ“¤ è¯·æ±‚ä½“ï¼ˆInsertRequestï¼‰

```json
{
  "document_index": 4008893141271707648,
  "resource_id": 4008893141271707648,
  "page_url": "åˆ†ç±»ä¸€/_å…¨çƒè´­_å‘å¸ƒè¿ç¦å•†å“_ä¿¡æ¯_ç»†åˆ™.html"
}
```

#### âœ… è¿”å›å€¼ï¼ˆæˆåŠŸï¼‰

```json
{
  "result": "ok",
  "document_index": 4008893141271707648,
  "inserted_chunks_milvus": 7,
  "inserted_chunks_es": 7
}
```
#### âŒ è¿”å›å€¼ï¼ˆå¤±è´¥ï¼‰

```json
{
  "result": "fail",
  "error": "HTML æ–‡ä»¶ä¸‹è½½å¤±è´¥"
}
```

---

### ğŸ—‘ï¸ `/delete` - åˆ é™¤æ–‡æ¡£

**å®Œæ•´è·¯å¾„**ï¼š`POST http://192.168.7.179:80/document/delete`

**æè¿°**ï¼šæ ¹æ®æ–‡æ¡£ç´¢å¼•ï¼Œä»æ–‡æ¡£åº“ä¸­åˆ é™¤è¯¥é¡µé¢å¯¹åº”çš„æ‰€æœ‰è¯­ä¹‰å—ï¼Œå¹¶ä¸”åˆ é™¤ä¿å­˜çš„æ–‡ä»¶ã€‚

#### ğŸ“¤ è¯·æ±‚ä½“ï¼ˆDeleteRequestï¼‰

```json
{
  "document_index": 4008893141271707648,
  "page_url": "åˆ†ç±»ä¸€/_å…¨çƒè´­_å‘å¸ƒè¿ç¦å•†å“_ä¿¡æ¯_ç»†åˆ™.html"
}
```

#### âœ… è¿”å›å€¼ï¼ˆæˆåŠŸï¼‰

```json
{
  "result": "ok",
  "document_index": 4008893141271707648,
  "deleted_chunks_milvus": 7,
  "deleted_chunks_es": 7
}
```
#### âŒ è¿”å›å€¼ï¼ˆå¤±è´¥ï¼‰

```json
{
  "result": "fail",
  "error": "åˆ é™¤å¤±è´¥: å‘é‡åº“è¿æ¥å¤±è´¥"
}
```

---

### ğŸ” `/query_rewrite` - é‡å†™ Query

**å®Œæ•´è·¯å¾„**ï¼š`POST http://192.168.7.179:80/document/query_rewrite`

**æè¿°**ï¼šåŸºäºå†å²å¯¹è¯è¯­å¢ƒå’Œå½“å‰ query ç”Ÿæˆè¯­ä¹‰æ›´å®Œæ•´çš„æ–°æŸ¥è¯¢ï¼Œç”¨äºæå‡å¤šè½®é—®ç­”å‡†ç¡®æ€§ã€‚

#### ğŸ“¤ è¯·æ±‚ä½“ï¼ˆRewriteRequestï¼‰

```json
{
  "dialogue": 
  [
    {"speaker": "user", "text": "æˆ‘æ‰“ç®—åšä¸€åœºæ–°å“ç›´æ’­ï¼Œæœ‰ä»€ä¹ˆå»ºè®®ï¼Ÿ"}, 
    {"speaker": "assistant", "text": "å»ºè®®æå‰3å¤©é¢„çƒ­ï¼Œå‡†å¤‡é¢„å”®é“¾æ¥å¹¶é‚€è¯·è¾¾äººå¸¦æ’­ã€‚"}, 
    {"speaker": "user", "text": "æˆ‘ä»¬é¢„ç®—ç´§å¼ ï¼Œè¯·é—®è¾¾äººè´¹ç”¨èƒ½çœå—ï¼Ÿ"}, 
    {"speaker": "assistant", "text": "å¯ä»¥é€‰æ‹©å¹³å°å…è´¹è¾¾äººå…±åˆ›æœåŠ¡ï¼Œæˆ–ç”¨ä¸­è…°éƒ¨è¾¾äººè¿›è¡Œåˆä½œã€‚"}, 
    {"speaker": "user", "text": "é‚£å¦‚æœæˆ‘ä»¬å°±æ˜¯å°å•†å®¶å‘¢ï¼Ÿ"}], 
  "final_query": "é‚£å¦‚æœæˆ‘ä»¬å°±æ˜¯å°å•†å®¶å‘¢ï¼Ÿ"
}

```

#### âœ… è¿”å›å€¼ï¼ˆæˆåŠŸï¼‰

```json
{
  "status": "ok",
  "rewritten_query": "è‹¥æ˜¯å°å•†å®¶è¿›è¡Œæ–°å“ç›´æ’­æ¨å¹¿ï¼Œåœ¨é¢„ç®—æœ‰é™çš„æƒ…å†µä¸‹åº”å¦‚ä½•è§„åˆ’è¾¾äººåˆä½œï¼Ÿ"
}
``` 

#### âŒ è¿”å›å€¼ï¼ˆå¤±è´¥ï¼‰

```json
{
  "status": "fail",
  "error": "é‡å†™å¤±è´¥: VLLM è¯·æ±‚è¶…æ—¶"
}
```

### ğŸ©º `/ping` - å¥åº·æ£€æŸ¥

**å®Œæ•´è·¯å¾„**ï¼š`GET http://192.168.7.179:80/document/ping`

**æè¿°**ï¼šæœåŠ¡å­˜æ´»æ¢æµ‹æ¥å£ï¼Œç”¨äºéƒ¨ç½²ç›‘æ§ä¸å¥åº·æ£€æŸ¥ã€‚

#### ğŸ“¥ è¿”å›å€¼

```json
{
  "status": "ok"
}
```
